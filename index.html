<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Money Manager</title>
    <meta name="description" content="Simple offline money manager PWA">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#121212">
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="script.js" defer></script>
</head>

<body>
    <div id="app">
        <header>
            <h1>Money Manager</h1>
        </header>

        <main id="main-content">
            <!-- Dashboard View -->
            <section id="view-dashboard" class="view active">
                <div class="card total-balance-card">
                    <h2>総資産</h2>
                    <p class="balance-amount" id="total-balance">¥0</p>
                </div>

                <div class="form-group" style="margin-bottom: 1rem;">
                    <select id="dashboard-account-filter" style="padding: 10px; font-size: 0.9rem;">
                        <option value="all">全ての口座</option>
                        <!-- Populated by JS -->
                    </select>
                </div>

                <div class="charts-grid">
                    <div class="chart-container">
                        <canvas id="expenseChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <canvas id="incomeChart"></canvas>
                    </div>
                </div>

                <div class="list-header">
                    <h3>最近の取引</h3>
                    <button id="refresh-charts-btn" class="icon-btn">↻</button>
                </div>
                <ul id="transaction-list" class="transaction-list">
                    <!-- Transactions go here -->
                </ul>
            </section>

            <!-- Add View -->
            <section id="view-add" class="view hidden">
                <h2>取引追加</h2>
                <form id="transaction-form">
                    <div class="toggle-group">
                        <input type="radio" name="type" id="type-expense" value="expense" checked>
                        <label for="type-expense">支出</label>
                        <input type="radio" name="type" id="type-income" value="income">
                        <label for="type-income">収入</label>
                    </div>

                    <div class="form-group">
                        <label for="date">日付</label>
                        <input type="date" id="date" required>
                    </div>

                    <div class="form-group">
                        <label for="amount">金額</label>
                        <input type="number" id="amount" placeholder="0" required inputmode="numeric">
                    </div>

                    <div class="form-group">
                        <label for="category">カテゴリ</label>
                        <select id="category">
                            <!-- Populated by JS -->
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="account">口座</label>
                        <select id="account">
                            <!-- Populated by JS -->
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="description">メモ</label>
                        <input type="text" id="description" placeholder="詳細...">
                    </div>

                    <button type="submit" class="btn-primary">保存</button>
                </form>
            </section>

            <!-- Accounts View -->
            <section id="view-accounts" class="view hidden">
                <h2>口座管理</h2>
                <div id="accounts-list" class="accounts-list">
                    <!-- Account cards -->
                </div>

                <form id="account-form" class="mt-4">
                    <h3>新規口座作成</h3>
                    <div class="form-group">
                        <input type="text" id="new-account-name" placeholder="口座名 (例: 財布)" required>
                    </div>
                    <div class="form-group">
                        <input type="number" id="new-account-balance" placeholder="初期残高" required inputmode="numeric">
                    </div>
                    <button type="submit" class="btn-secondary">追加</button>
                </form>
            </section>

            <!-- Analytics View -->
            <section id="view-analytics" class="view hidden">
                <h2>月別分析</h2>

                <div class="month-selector-card card"
                    style="display: flex; justify-content: space-between; align-items: center; padding: 1rem; margin-bottom: 1.5rem;">
                    <button id="analytics-prev-month" class="icon-btn" style="width: 40px; height: 40px;">&lt;</button>
                    <h3 id="analytics-current-month" style="margin: 0; font-size: 1.2rem;">2026年2月</h3>
                    <button id="analytics-next-month" class="icon-btn" style="width: 40px; height: 40px;">&gt;</button>
                </div>

                <!-- Calendar View -->
                <div class="card" style="padding: 1rem; margin-bottom: 1.5rem;">
                    <h4 style="margin-bottom: 0.5rem; font-size: 0.9rem; color: var(--secondary-text);">月間カレンダー
                    </h4>
                    <div class="calendar-header">
                        <span>日</span><span>月</span><span>火</span><span>水</span><span>木</span><span>金</span><span>土</span>
                    </div>
                    <div id="analytics-calendar" class="calendar-grid">
                        <!-- Days populated by JS -->
                    </div>
                </div>

                <!-- Selected Date Transactions -->
                <div id="selected-date-container" class="hidden" style="margin-bottom: 1.5rem;">
                    <h4 id="selected-date-title"
                        style="margin-bottom: 0.5rem; font-size: 0.9rem; color: var(--secondary-text); padding-left: 0.5rem;">
                    </h4>
                    <ul id="selected-date-transactions" class="transaction-list">
                        <!-- Populated by JS -->
                    </ul>
                </div>

                <div class="stats-grid"
                    style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem;">
                    <div class="card" style="padding: 1rem; text-align: center; margin-bottom: 0;">
                        <h4 style="margin-bottom: 0.5rem; font-size: 0.9rem; color: var(--secondary-text);">収入</h4>
                        <p id="analytics-income" class="amount-income" style="font-size: 1.2rem; font-weight: bold;">¥0
                        </p>
                    </div>
                    <div class="card" style="padding: 1rem; text-align: center; margin-bottom: 0;">
                        <h4 style="margin-bottom: 0.5rem; font-size: 0.9rem; color: var(--secondary-text);">支出</h4>
                        <p id="analytics-expense" class="amount-expense" style="font-size: 1.2rem; font-weight: bold;">
                            ¥0</p>
                    </div>
                </div>

                <div class="card" style="padding: 1rem; text-align: center; margin-bottom: 1.5rem;">
                    <h4 style="margin-bottom: 0.5rem; font-size: 0.9rem; color: var(--secondary-text);">収支差引</h4>
                    <p id="analytics-balance" style="font-size: 1.5rem; font-weight: bold;">¥0</p>
                </div>

                <div class="charts-grid">
                    <div class="chart-container">
                        <canvas id="analyticsExpenseChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <canvas id="analyticsIncomeChart"></canvas>
                    </div>
                </div>

                <div class="card" style="padding: 1rem; margin-bottom: 2rem;">
                    <h4 style="margin-bottom: 1rem; font-size: 0.9rem; color: var(--secondary-text);">資産推移 (過去6ヶ月)</h4>
                    <div class="chart-container" style="height: 250px;">
                        <canvas id="assetTrendChart"></canvas>
                    </div>
                </div>
            </section>

            <!-- Settings View -->
            <section id="view-settings" class="view hidden">
                <h2>設定</h2>

                <div class="settings-group">
                    <h3>カテゴリ設定</h3>
                    <div class="toggle-group" style="margin-bottom: 1rem;">
                        <input type="radio" name="cat-settings-type" id="cat-set-expense" value="expense" checked>
                        <label for="cat-set-expense">支出</label>
                        <input type="radio" name="cat-settings-type" id="cat-set-income" value="income">
                        <label for="cat-set-income">収入</label>
                    </div>
                    <ul id="settings-category-list" class="transaction-list">
                        <!-- Populated by JS -->
                    </ul>
                    <form id="add-category-form" style="display: flex; gap: 8px; margin-top: 1rem;">
                        <input type="text" id="new-category-name" placeholder="新しいカテゴリ" required
                            style="flex: 1; padding: 12px;">
                        <button type="submit" class="btn-primary" style="width: auto; padding: 0 1.5rem;">+</button>
                    </form>
                </div>

                <div class="settings-group">
                    <h3>テーマ設定</h3>
                    <div class="toggle-group" style="margin-bottom: 0;">
                        <input type="radio" name="theme" id="theme-dark" value="dark" checked>
                        <label for="theme-dark">ダーク</label>
                        <input type="radio" name="theme" id="theme-light" value="light">
                        <label for="theme-light">ライト</label>
                    </div>
                </div>

                <div class="settings-group">
                    <h3>データ管理</h3>
                    <button id="export-btn" class="btn-outline">データのバックアップ (JSON)</button>
                    <button id="export-csv-btn" class="btn-outline">CSVエクスポート (Excel用)</button>

                    <div class="file-input-wrapper">
                        <input type="file" id="import-input" accept=".json">
                        <button id="import-btn-trigger" class="btn-outline">データの復元</button>
                    </div>

                    <button id="reset-btn" class="btn-danger">全データ削除</button>
                </div>

                <div class="settings-group">
                    <h3>アプリ情報</h3>
                    <p>Version 1.0.0</p>
                </div>
            </section>
        </main>

        <nav class="bottom-nav">
            <button class="nav-item active" data-target="view-dashboard">
                <span class="icon">🏠</span>
                <span class="label">ホーム</span>
            </button>
            <button class="nav-item" data-target="view-add" data-mode="expense">
                <span class="icon">💸</span>
                <span class="label">支出</span>
            </button>
            <button class="nav-item" data-target="view-add" data-mode="income">
                <span class="icon">💰</span>
                <span class="label">収入</span>
            </button>
            <button class="nav-item" data-target="view-accounts">
                <span class="icon">💳</span>
                <span class="label">口座</span>
            </button>
            <button class="nav-item" data-target="view-analytics">
                <span class="icon">📊</span>
                <span class="label">分析</span>
            </button>
            <button class="nav-item" data-target="view-settings">
                <span class="icon">⚙️</span>
                <span class="label">設定</span>
            </button>
        </nav>
    </div>
</body>

</html>